<UserControl x:Class="BurnRate.Views.Controls.ModelUsageBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignWidth="320" d:DesignHeight="200">

    <Border Style="{StaticResource CardBorder}">
        <StackPanel>
            <!-- Section header -->
            <TextBlock Text="MODEL USAGE"
                       Style="{StaticResource SectionHeader}" />

            <!-- Model bar items -->
            <ItemsControl ItemsSource="{Binding BarItems, RelativeSource={RelativeSource AncestorType=UserControl}}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="80" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="46" />
                            </Grid.ColumnDefinitions>

                            <!-- Model short name -->
                            <TextBlock Grid.Column="0"
                                       Text="{Binding ModelName}"
                                       FontSize="11"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       VerticalAlignment="Center"
                                       TextTrimming="CharacterEllipsis"
                                       ToolTip="{Binding ModelName}" />

                            <!-- Bar track with proportional fill -->
                            <Grid Grid.Column="1"
                                  Margin="6,0"
                                  VerticalAlignment="Center"
                                  Height="8"
                                  ToolTip="{Binding FormattedTokens}">
                                <!-- Full track background -->
                                <Border Background="{DynamicResource GaugeTrackBrush}"
                                        CornerRadius="3" />
                                <!-- Filled portion using star-width grid -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="{Binding FilledWidth}" />
                                        <ColumnDefinition Width="{Binding EmptyWidth}" />
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0"
                                            Background="{Binding BarBrush}"
                                            CornerRadius="3" />
                                </Grid>
                            </Grid>

                            <!-- Percentage label -->
                            <TextBlock Grid.Column="2"
                                       FontSize="11"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right">
                                <TextBlock.Text>
                                    <Binding Path="Percentage" StringFormat="{}{0:0}%" />
                                </TextBlock.Text>
                            </TextBlock>
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Empty state -->
            <TextBlock x:Name="EmptyState"
                       Text="No model data available"
                       FontSize="11"
                       Foreground="{DynamicResource TextMutedBrush}"
                       HorizontalAlignment="Center"
                       Margin="0,8"
                       Visibility="Collapsed" />
        </StackPanel>
    </Border>
</UserControl>
